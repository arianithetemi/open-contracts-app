<div class="col-12">
  <div *ngFor="let user of users; let i = index" class="container">
    <div class="row border-top" @fade>
      <div class="img-col col-md-1" id="image-col">
        <div *ngIf="user.role == 'user' && user.isActive == true">
          <img src="/assets/images/zyrtari.png" class="img-fluid">
        </div>
        <div *ngIf="user.role == 'admin' || user.role == 'superadmin' && user.isActive == true">
          <img src="/assets/images/administratori.png" class="img-fluid">
        </div>
        <div *ngIf="user.role == 'user' && user.isActive == false">
          <img src="/assets/images/zyrtariInactive.png" class="img-fluid">
        </div>
        <div *ngIf="user.role == 'admin' || user.role == 'superadmin' && user.isActive == false">
          <img src="/assets/images/administratorInactive.png" class="img-fluid">
        </div>
      </div>
      <div class="user-info col-md-2">
        <div *ngIf="user.isActive == false">
          <p class="name-is-false">{{ user.firstName }} {{ user.lastName }}</p>
        </div>
        <div *ngIf="user.isActive == true">
          <p class="name">
            <a>{{ user.firstName }} {{ user.lastName }}</a>
          </p>
        </div>
        <div *ngIf="user.role == 'user'">
          <p class="position"> Përdorues </p>
        </div>
        <div *ngIf="user.role == 'admin'">
          <p class="position">Administrator</p>
        </div>
      </div>
      <div class="col-md-8">
        <p id="comment">
          {{user.comment}}
          <span style="color: #868e96; margin-left: 10px"> |</span>
          <span id="delete" data-toggle="tooltip" title="Fshije komentin" (click)="deleteComment($event)">
            <u [attr.data-id]="user._id">Fshije</u>
          </span>
        </p>
        <p class="dateTime">
          <i>{{user.dateTime}}</i>
        </p>
      </div>
      <div class="col-md-1 float right" id="reply-icon">
        <span>
          <i class="fa fa-reply" aria-hidden="true" (click)="show(i)"></i>
        </span>
      </div>
      <div class="col-12" style="padding-right: 0px">
        <div>
          <div>
            <div>
              <div class="row" *ngFor="let replyUser of user.reply">
                <div class="col-md-1"></div>
                <div class="col-md-2"></div>
                <div class="col-md-9 replies">
                  <div class="user-info">
                    <p class="name" @fade>{{ replyUser.firstName }} {{ replyUser.lastName }}
                      <span *ngIf="user.role == 'user'" class="position"> (Përdorues) </span>
                      <span *ngIf="user.role == 'admin'" class="position"> (Administrator) </span>
                      <span *ngIf="user.role == 'superadmin'" class="position"> (Superadmin) </span>
                    </p>
                  </div>
                  <div style="padding-left: 0">
                    <p class="reply" @fade>{{ replyUser.replyComment}}
                      <span style="color: #868e96; margin-left: 10px"> |</span>
                      <span id="delete" data-toggle="tooltip" title="Fshije komentin" (click)="deleteReply($event)">
                        <u [attr.data-id]="user._id" [attr.data-replyid]="replyUser._id">Fshije</u>
                      </span>
                    </p>
                    <p class="dateTime" @fade>
                      <i>{{ replyUser.replyDateTime}}</i>
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-12" *ngIf="isShown[i]" style="padding-right: 0px">
          <div>
            <div class="container">
              <div class="row">
                <div class="col-md-1" style="padding: 0"></div>
                <div class="col-md-2"></div>
                <div class="col-md-9 border-bottom replies" style="margin-left: -25px;">
                  <div>
                    <p id="name-reply">
                      {{ currentUser.firstName }} {{ currentUser.lastName }}
                      <span *ngIf="currentUser.role == 'user'" class="position"> (Përdorues) </span>
                      <span *ngIf="currentUser.role == 'admin'" class="position"> (Administrator) </span>
                      <span *ngIf="currentUser.role == 'superadmin'" class="position"> (Superadmin) </span>
                    </p>
                  </div>
                  <form #commentReplyForm="ngForm" novalidate (submit)="addReply($event, commentReply.valid)" [attr.data-id]="user._id">
                    <input class="form-control" name="commentReply" [(ngModel)]="replyComment" type="text" id="text" #commentReply="ngModel"
                      required [style.border-color]="commentReply.errors?.required && (commentReply.touched || commentReplyForm.submitted) ? 'red': '#ced4da'">
                    <button class="btn btn-info" type="submit" id="submit"  
                      [style.border-color]="commentReply.errors?.required && (commentReply.touched || commentReplyForm.submitted) ? 'red': '#ced4da'">Dërgo</button>
                  </form>
                  <div *ngIf="commentReply.errors?.required && (commentReply.touched || commentReplyForm.submitted)" class="text-danger">Duhet shtypur një mesazh!</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-12">
    <div class="container">
      <div class="row">
        <div class="col-md-1">
          <div *ngIf="currentUser.role == 'user'">
            <img src="/assets/images/zyrtari.png" class="img-fluid">
          </div>
          <div *ngIf="currentUser.role == 'admin' || currentUser.role == 'superadmin'">
            <img src="/assets/images/administratori.png" class="img-fluid">
          </div>
        </div>
        <div class="user-info col-md-2">
          <div>
            <p class="name">
              <a>{{ currentUser.firstName }} {{ currentUser.lastName }}</a>
            </p>
          </div>
          <div *ngIf="currentUser.role == 'user'">
            <p class="position"> Përdorues </p>
          </div>
          <div *ngIf="currentUser.role == 'admin'">
            <p class="position">Administrator</p>
          </div>
        </div>
        <div class="col-md-9">
          <form #commentForm="ngForm" novalidate>
            <input class="form-control" name="comment" [(ngModel)]="commentModal.comment" type="text" id="text" 
              #comment="ngModel" required [style.border-color]="comment.errors?.required && (comment.touched || commentForm.submitted) ? 'red': '#ced4da'">
            <button class="btn btn-info" type="submit" value="submit" id="submit" [attr.data-id]="currentUser._id" (click)="addComment($event, commentForm.valid)"
            [style.border-color]="comment.errors?.required && (comment.touched || commentForm.submitted) ? 'red': '#ced4da'">Dërgo</button>
          </form>
          <div *ngIf="comment.errors?.required && (comment.touched || commentForm.submitted)" class="text-danger">Duhet shtypur një mesazh!</div>
        </div>
      </div>
    </div>
  </div>